{"version":3,"file":"value-format.js","names":["_react","_interopRequireDefault","require","_server","_moment","_numeral","_lodash","_visualizationsSettings","obj","__esModule","default","numeral","options","scalePercentBy100","urlPattern","hasOwnProperty","Object","prototype","createTextFormatter","highlightLinks","value","isString","Link","visualizationsSettings","LinkComponent","replace","unused","prefix","href","link","ReactDOMServer","renderToStaticMarkup","createElement","target","rel","toString","toMoment","moment","isMoment","isFinite","ISO_8601","RFC_2822","createDateTimeFormatter","format","wrapped","isValid","createBooleanFormatter","values","isArray","length","isNil","createNumberFormatter","n","set","formatSimpleTemplate","str","data","match","prop","call","isUndefined"],"sources":["../../src/lib/value-format.tsx"],"sourcesContent":["import React from \"react\";\nimport ReactDOMServer from \"react-dom/server\";\nimport moment from \"moment/moment\";\nimport numeral from \"numeral\";\nimport { isString, isArray, isUndefined, isFinite, isNil, toString } from \"lodash\";\nimport { visualizationsSettings } from \"@/visualizations/visualizationsSettings\";\n\nnumeral.options.scalePercentBy100 = false;\n\n// eslint-disable-next-line\nconst urlPattern = /(^|[\\s\\n]|<br\\/?>)((?:https?|ftp):\\/\\/[\\-A-Z0-9+\\u0026\\u2019@#\\/%?=()~_|!:,.;]*[\\-A-Z0-9+\\u0026@#\\/%=~()_|])/gi;\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport function createTextFormatter(highlightLinks: any) {\n  if (highlightLinks) {\n    return (value: any) => {\n      if (isString(value)) {\n        const Link = visualizationsSettings.LinkComponent;\n        value = value.replace(urlPattern, (unused, prefix, href) => {\n          const link = ReactDOMServer.renderToStaticMarkup(\n            <Link href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n              {href}\n            </Link>\n          );\n          return prefix + link;\n        });\n      }\n      return toString(value);\n    };\n  }\n  return (value: any) => toString(value);\n}\n\nfunction toMoment(value: any) {\n  if (moment.isMoment(value)) {\n    return value;\n  }\n  if (isFinite(value)) {\n    return moment(value);\n  }\n  // same as default `moment(value)`, but avoid fallback to `new Date()`\n  return moment(toString(value), [moment.ISO_8601, moment.RFC_2822]);\n}\n\nexport function createDateTimeFormatter(format: any) {\n  if (isString(format) && format !== \"\") {\n    return (value: any) => {\n      const wrapped = toMoment(value);\n      return wrapped.isValid() ? wrapped.format(format) : toString(value);\n    };\n  }\n  return (value: any) => toString(value);\n}\n\nexport function createBooleanFormatter(values: any) {\n  if (isArray(values)) {\n    if (values.length >= 2) {\n      // Both `true` and `false` specified\n      return (value: any) => {\n        if (isNil(value)) {\n          return \"\";\n        }\n        return \"\" + values[value ? 1 : 0];\n      };\n    } else if (values.length === 1) {\n      // Only `true`\n      return (value: any) => (value ? values[0] : \"\");\n    }\n  }\n  return (value: any) => {\n    if (isNil(value)) {\n      return \"\";\n    }\n    return value ? \"true\" : \"false\";\n  };\n}\n\nexport function createNumberFormatter(format: any) {\n  if (isString(format) && format !== \"\") {\n    const n = numeral(0); // cache `numeral` instance\n    return (value: any) => (value === null || value === \"\" ? \"\" : n.set(value).format(format));\n  }\n  return (value: any) => toString(value);\n}\n\nexport function formatSimpleTemplate(str: any, data: any) {\n  if (!isString(str)) {\n    return \"\";\n  }\n  return str.replace(/{{\\s*([^\\s]+?)\\s*}}/g, (match, prop) => {\n    if (hasOwnProperty.call(data, prop) && !isUndefined(data[prop])) {\n      return data[prop];\n    }\n    return match;\n  });\n}\n"],"mappings":"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"}